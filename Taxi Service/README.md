# Прогноз количества заказов для сервиса такси

[HTML]() [ipynb]()

## Описание проекта

Заказчик - компания такси - собрал исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Надо построить модель для такого предсказания.

Оценку качества модели следует проводить по метрике *RMSE*.

### План проекта

1. Загрузить данные и выполнить ресемплирование по одному часу.
2. Проанализировать данные.
3. Обучить разные модели. 
4. Проверить модели на тестовой выборке, выбрать лучшую.

### Результаты

С помощью функции `statsmodels.tsa.seasonal.seasonal_decompose` ряд был разбит на тренд, сезонную составляющую и случайные остатки.

Выяснили, что ряд имеет следующие характеристики:

1. Есть общий тренд, он растущий и мультипликативный, более чем 2-го порядка.
2. Присутствуют как минимум две сезонности: недельная и 24-часовая.
3. Достаточно велика случайная составляющая, что является теоретическим пределом для качества модели.

На основании полученной информации были сформированы следующие признаки для обучения модели:
1. Заменили даты на последовательно увеличивающиеся номера наблюдений.
2. Ввели номер часа в сутках, чтобы учесть внутридневные сезонности.
3. Ввели номер дня в неделе, чтобы учесть внутринедельные сезонности.
4. Ввели лаги в 12 и 24 часа, для внутридневной сезонности.
5. Ввели лаг в 7 * 24 часа, для недельной сезонности.
6. Ввели скользящие средние в 12, 24, 7 * 24 часов.
7. Ввели квадрат номера наблюдения, чтобы учесть нелинейность тренда.

Далее при разных гипер параметрах были испытаны три типа моделей:
- Линейная регрессия
- Случайный лес
- CatBoost

Выяснилось, что на обучающей выборке все модели показали практически одинаковое значение RMSE. 

По итогам тестирования определилось, что наилучшей оказалась линейная регрессия с RMSE около 35. Она была выбрана для передачи в производство.

Есть ли возможности для улучшения точности модели? Да, есть. Следует поэкспериментировать с признаками. 

Например:

- Подмешать данные более старшего временного масштаба - 1 день
- Подмешать данные более мелкого масштаба - 10 минут
- Добавить скользящие средние по этим данным
- Добавить куб номера наблюдения.

Так же исследовать значимость признаков. Это вопрос, который в данном проекте не рассматривался.

При эксплуатации следует предусмотреть переобучение модели каждую неделю. Характеристики временных рядов постепенно уходят и модель должна следить за этим.