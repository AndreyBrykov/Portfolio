# Улучшение процесса обогащения золота

[HTML]() [ipynb]()

## Постановка задачи

Заказчиком является инжиниринговая компания, которая разрабатывает решения для эффективной работы промышленных предприятий.

Требуется подготовить прототип модели машинного обучения, которая должна предсказать коэффициент восстановления золота из золотосодержащей руды. Модель поможет оптимизировать производство, чтобы не запускать предприятие с убыточными характеристиками.

## Данные
В нашем распоряжении имеются данные с параметрами добычи и очистки. 

Данные находятся в трёх файлах:
- **gold_recovery_train.csv** — обучающая выборка;
- **gold_recovery_test.csv** — тестовая выборка;
- **gold_recovery_full.csv** — исходные данные.

Данные индексируются датой и временем получения информации (признак date). Соседние по времени параметры часто похожи.
Некоторые параметры недоступны, потому что замеряются и/или рассчитываются значительно позже. Из-за этого в тестовой выборке отсутствуют некоторые признаки, которые могут быть в обучающей. Также в тестовом наборе нет целевых признаков.<br/>
Исходный датасет содержит обучающую и тестовую выборки со всеми признаками.<br/>

Данные в нашем распоряжении являются сырыми: их просто выгрузили из хранилища. Прежде чем приступить к построению модели, требуется проверить их на корректность согласно согласованной с заказчиком инструкции.

## Наименование признаков
Наименование признаков строится по следующему правилу:

`[этап].[тип_параметра].[название_параметра]`
    

Пример: `rougher.input.feed_ag`

Возможные значения для блока `[этап]`:
- **rougher** — флотация
- **primary_cleaner** — первичная очистка
- **secondary_cleaner** — вторичная очистка
- **final** — финальные характеристики

Возможные значения для блока `[тип_параметра]`:
- **input** — параметры сырья
- **output** — параметры продукта
- **state** — параметры, характеризующие текущее состояние этапа
- **calculation** — расчётные характеристики

## План работы

0. Загрузить библиотеки.<br/>
0.1. Потребуются библиотеки pandas, matplotlib, sklearn


1. Подготовка данных<br/>
1.1. Открыть и изучить файлы.<br/> 
1.2. Провести предобработку данных. Убрать или заменить пропуски, привести данные к нужным типам.<br/>
1.3. Проверить, что эффективность обогащения рассчитана правильно. Вычислить её на обучающей выборке для признака rougher.output.recovery. Найти MAE между расчитанным и имеющимся значением признака. Описать выводы.<br/>
1.4. Проанализировать признаки, недоступные в тестовой выборке. Что это за параметры? К какому типу относятся?<br/>


2. Проанализировать данные<br/>
2.1. Изучить, как меняется концентрация металлов (Au, Ag, Pb) на различных этапах очистки. Описать выводы.<br/>
2.2. Сравнить распределения размеров гранул сырья на обучающей и тестовой выборках. **Если распределения сильно отличаются друг от друга, оценка модели будет неправильной**.<br/>
2.3. Исследовать суммарную концентрацию всех веществ на разных стадиях: в сырье, в черновом и финальном концентратах. Проверить, есть ли аномальные значения в суммарном распределении. Определить, если они есть, следует ли их удалять из обеих выборок? Описать выводы и удалить аномалии в соответствии с принятыми правилами, если найдутся.


3. Построить модель<br/>
3.1. Написать функцию для вычисления итоговой **sMAPE**.<br/>
3.2. Обучить разные модели и оценить их качество кросс-валидацией.<br/> 
3.3. Выбрать лучшую модель и проверить её на тестовой выборке.<br/> 
3.4. Описать выводы.